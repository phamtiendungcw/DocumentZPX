# üìë Ph√¢n t√≠ch v√† Thi·∫øt k·∫ø H·ªá th·ªëng ZylPelox (ZPX) - VERSION 1.3

**M√£ d·ª± √°n:** ZPX-ECOM
**Ng√†y kh·ªüi t·∫°o:** 10-02-2023
**Ng√†y c·∫≠p nh·∫≠t:** 14-04-2025
**T√°c gi·∫£:** phamtiendungcw
**Phi√™n b·∫£n:** 1.3

---

## 1. T·ªîNG QUAN D·ª∞ √ÅN

### 1.1. M·ª•c ti√™u

X√¢y d·ª±ng n·ªÅn t·∫£ng c·ª≠a h√†ng b√°n l·∫ª tr·ª±c tuy·∫øn ZylPelox (ZPX) v·ªõi ki·∫øn tr√∫c hi·ªán ƒë·∫°i, t√≠ch h·ª£p ƒë·∫ßy ƒë·ªß t√≠nh nƒÉng qu·∫£n l√Ω t·ª´ ƒë·∫ßu ƒë·∫øn cu·ªëi, ƒë√°p ·ª©ng nhu c·∫ßu kinh doanh ƒëa k√™nh v·ªõi kh·∫£ nƒÉng m·ªü r·ªông cao v√† b·∫£o tr√¨ d·ªÖ d√†ng.

> **_Ch√∫ th√≠ch:_** _D·ª± √°n nh·∫±m t·∫°o ra m·ªôt n·ªÅn t·∫£ng eCommerce to√†n di·ªán, kh√¥ng ch·ªâ ƒë√°p ·ª©ng nhu c·∫ßu hi·ªán t·∫°i m√† c√≤n c√≥ kh·∫£ nƒÉng m·ªü r·ªông trong t∆∞∆°ng lai._

### 1.2. Ph·∫°m vi

- **H·ªá th·ªëng qu·∫£n l√Ω b√°n h√†ng v√† t·ªìn kho to√†n di·ªán**: Theo d√µi s·∫£n ph·∫©m, ƒë∆°n h√†ng v√† t·ªìn kho theo th·ªùi gian th·ª±c
- **N·ªÅn t·∫£ng eCommerce ƒë·∫ßy ƒë·ªß ch·ª©c nƒÉng**: Tr·∫£i nghi·ªám mua s·∫Øm tr·ª±c tuy·∫øn li·ªÅn m·∫°ch cho kh√°ch h√†ng
- **T√≠ch h·ª£p thanh to√°n v√† v·∫≠n chuy·ªÉn**: H·ªó tr·ª£ nhi·ªÅu ph∆∞∆°ng th·ª©c thanh to√°n v√† ƒë·ªëi t√°c v·∫≠n chuy·ªÉn
- **H·ªá th·ªëng CRM v√† qu·∫£n l√Ω kh√°ch h√†ng**: Qu·∫£n l√Ω th√¥ng tin v√† t∆∞∆°ng t√°c v·ªõi kh√°ch h√†ng
- **Dashboard qu·∫£n tr·ªã v√† b√°o c√°o**: C√¥ng c·ª• ph√¢n t√≠ch d·ªØ li·ªáu v√† b√°o c√°o to√†n di·ªán

> **_Ch√∫ th√≠ch:_** _D·ª± √°n s·∫Ω bao g·ªìm c·∫£ backend v√† frontend, API ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ d·ªÖ d√†ng m·ªü r·ªông v√† t√≠ch h·ª£p v·ªõi c√°c h·ªá th·ªëng kh√°c._

### 1.3. Gi·ªõi h·∫°n

- **Kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu v√† truy c·∫≠p**: H·ªá th·ªëng ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ x·ª≠ l√Ω kh·ªëi l∆∞·ª£ng d·ªØ li·ªáu v√† ng∆∞·ªùi d√πng t·ª´ trung b√¨nh ƒë·∫øn l·ªõn (l√™n ƒë·∫øn 100,000 s·∫£n ph·∫©m, 50,000 ng∆∞·ªùi d√πng ƒë·ªìng th·ªùi)
- **Th·ªùi gian ph√°t tri·ªÉn d·ª± ki·∫øn**: 6-9 th√°ng cho phi√™n b·∫£n MVP, v·ªõi l·ªô tr√¨nh ph√°t tri·ªÉn ti·∫øp theo ƒë∆∞·ª£c chia th√†nh c√°c giai ƒëo·∫°n
- **Quy m√¥ nh√≥m ph√°t tri·ªÉn**: Y√™u c·∫ßu ƒë·ªôi ng≈© 5-8 ng∆∞·ªùi bao g·ªìm backend, frontend, QA v√† DevOps

> **_Ch√∫ th√≠ch:_** _C√°c gi·ªõi h·∫°n ƒë∆∞·ª£c x√°c ƒë·ªãnh ƒë·ªÉ ƒë·∫∑t k·ª≥ v·ªçng r√µ r√†ng v√† ƒë·∫£m b·∫£o vi·ªác l·∫≠p k·∫ø ho·∫°ch t√†i nguy√™n ph√π h·ª£p._

---

## 2. Y√äU C·∫¶U CH·ª®C NƒÇNG (T√çNH NƒÇNG H·ªÜ TH·ªêNG)

### 2.1. Qu·∫£n l√Ω Catalog

- **S·∫£n ph·∫©m v√† bi·∫øn th·ªÉ**
  - T·∫°o/s·ª≠a/x√≥a/kh√¥i ph·ª•c s·∫£n ph·∫©m v·ªõi giao di·ªán qu·∫£n tr·ªã tr·ª±c quan
  - Qu·∫£n l√Ω bi·∫øn th·ªÉ kh√¥ng gi·ªõi h·∫°n (m√†u s·∫Øc, k√≠ch th∆∞·ªõc, v.v.)
  - Th√¥ng s·ªë k·ªπ thu·∫≠t v√† m√¥ t·∫£ ƒëa d·∫°ng v·ªõi ƒë·ªãnh d·∫°ng phong ph√∫ (rich text)
  - Gi√° c·∫£ v√† thu·∫ø c√≥ th·ªÉ c·∫•u h√¨nh theo khu v·ª±c

> **_Ch√∫ th√≠ch:_** _H·ªá th·ªëng s·∫Ω h·ªó tr·ª£ s·∫£n ph·∫©m ƒë∆°n gi·∫£n v√† s·∫£n ph·∫©m c√≥ nhi·ªÅu bi·∫øn th·ªÉ. M·ªói bi·∫øn th·ªÉ c√≥ th·ªÉ c√≥ gi√°, m√£ SKU v√† t·ªìn kho ri√™ng._

- **Danh m·ª•c**
  - C·∫•u tr√∫c danh m·ª•c ƒëa c·∫•p kh√¥ng gi·ªõi h·∫°n ƒë·ªô s√¢u
  - S·∫£n ph·∫©m c√≥ th·ªÉ thu·ªôc nhi·ªÅu danh m·ª•c kh√°c nhau
  - SEO t·ªëi ∆∞u cho t·ª´ng danh m·ª•c (meta title, description, URL)

> **_Ch√∫ th√≠ch:_** _Danh m·ª•c s·∫Ω ƒë∆∞·ª£c thi·∫øt k·∫ø v·ªõi hi·ªáu su·∫•t cao, ƒë·∫£m b·∫£o th·ªùi gian ph·∫£n h·ªìi nhanh ngay c·∫£ khi c√≥ h√†ng ngh√¨n s·∫£n ph·∫©m._

- **Qu·∫£n l√Ω ph∆∞∆°ng ti·ªán**
  - Th∆∞ vi·ªán h√¨nh ·∫£nh/video t·∫≠p trung v·ªõi b·ªô l·ªçc v√† t√¨m ki·∫øm
  - T·ªëi ∆∞u h√≥a h√¨nh ·∫£nh t·ª± ƒë·ªông (n√©n, thay ƒë·ªïi k√≠ch th∆∞·ªõc, chuy·ªÉn ƒë·ªïi ƒë·ªãnh d·∫°ng)
  - H·ªó tr·ª£ CDN ƒë·ªÉ tƒÉng t·ªëc t·∫£i trang

> **_Ch√∫ th√≠ch:_** _H·ªá th·ªëng s·∫Ω s·ª≠ d·ª•ng d·ªãch v·ª• l∆∞u tr·ªØ ƒë√°m m√¢y cho media ƒë·ªÉ ƒë·∫£m b·∫£o hi·ªáu su·∫•t v√† kh·∫£ nƒÉng m·ªü r·ªông._

### 2.2. Qu·∫£n l√Ω Kh√°ch h√†ng

- **H·ªì s∆° kh√°ch h√†ng chi ti·∫øt**: Th√¥ng tin c√° nh√¢n, l·ªãch s·ª≠ mua h√†ng, s·ªü th√≠ch
- **Ph√¢n nh√≥m kh√°ch h√†ng v√† tags**: Ph√¢n lo·∫°i kh√°ch h√†ng ƒë·ªÉ ti·∫øp th·ªã v√† ph√¢n t√≠ch
- **L·ªãch s·ª≠ mua h√†ng v√† t∆∞∆°ng t√°c**: Theo d√µi to√†n b·ªô h√†nh tr√¨nh kh√°ch h√†ng
- **H·ªá th·ªëng ƒë√°nh gi√° v√† ƒëi·ªÉm th∆∞·ªüng**: Khuy·∫øn kh√≠ch kh√°ch h√†ng quay l·∫°i
- **Qu·∫£n l√Ω ƒë·ªãa ch·ªâ giao h√†ng/thanh to√°n**: H·ªó tr·ª£ nhi·ªÅu ƒë·ªãa ch·ªâ cho m·ªói kh√°ch h√†ng

> **_Ch√∫ th√≠ch:_** _Module n√†y s·∫Ω t√≠ch h·ª£p v·ªõi h·ªá th·ªëng CRM ƒë·ªÉ cung c·∫•p c√°i nh√¨n 360 ƒë·ªô v·ªÅ kh√°ch h√†ng._

### 2.3. Qu·∫£n l√Ω Kho h√†ng

- **Theo d√µi t·ªìn kho theo th·ªùi gian th·ª±c**: C·∫≠p nh·∫≠t s·ªë l∆∞·ª£ng t·ªìn kho ngay khi c√≥ thay ƒë·ªïi
- **Nh·∫≠p/xu·∫•t kho v·ªõi l·ªãch s·ª≠ ƒë·∫ßy ƒë·ªß**: Theo d√µi m·ªçi thay ƒë·ªïi t·ªìn kho
- **Qu·∫£n l√Ω nhi·ªÅu kho v√† v·ªã tr√≠**: H·ªó tr·ª£ m√¥ h√¨nh kinh doanh ph√¢n t√°n
- **C·∫£nh b√°o t·ªìn kho th·∫•p**: Th√¥ng b√°o khi s·∫£n ph·∫©m g·∫ßn h·∫øt h√†ng
- **B√°o c√°o t·ªìn kho v√† gi√° tr·ªã h√†ng h√≥a**: Ph√¢n t√≠ch gi√° tr·ªã t·ªìn kho theo th·ªùi gian

> **_Ch√∫ th√≠ch:_** _H·ªá th·ªëng kho s·∫Ω ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ x·ª≠ l√Ω c·∫£ quy tr√¨nh th·ªß c√¥ng v√† t·ª± ƒë·ªông, t√≠ch h·ª£p v·ªõi c√°c thi·∫øt b·ªã qu√©t m√£ v·∫°ch n·∫øu c·∫ßn._

### 2.4. Qu·∫£n l√Ω V·∫≠n chuy·ªÉn

- **T√≠ch h·ª£p nhi·ªÅu ƒë·ªëi t√°c v·∫≠n chuy·ªÉn**: API-based integration v·ªõi c√°c ƒë∆°n v·ªã v·∫≠n chuy·ªÉn ph·ªï bi·∫øn
- **Ma tr·∫≠n ph√≠ v·∫≠n chuy·ªÉn t√πy ch·ªânh**: X√°c ƒë·ªãnh ph√≠ v·∫≠n chuy·ªÉn d·ª±a tr√™n khu v·ª±c, tr·ªçng l∆∞·ª£ng, gi√° tr·ªã
- **Theo d√µi tr·∫°ng th√°i v·∫≠n chuy·ªÉn**: C·∫≠p nh·∫≠t theo th·ªùi gian th·ª±c v·ªÅ t√¨nh tr·∫°ng ƒë∆°n h√†ng
- **In ·∫•n v·∫≠n ƒë∆°n v√† ƒë√≥ng g√≥i**: T·ª± ƒë·ªông t·∫°o v√† in v·∫≠n ƒë∆°n
- **X·ª≠ l√Ω ho√†n h√†ng**: Quy tr√¨nh ho√†n h√†ng v√† ho√†n ti·ªÅn ƒë·∫ßy ƒë·ªß

> **_Ch√∫ th√≠ch:_** _Module n√†y s·∫Ω cung c·∫•p API m·ªü ƒë·ªÉ d·ªÖ d√†ng t√≠ch h·ª£p v·ªõi c√°c nh√† cung c·∫•p d·ªãch v·ª• v·∫≠n chuy·ªÉn m·ªõi._

### 2.5. Qu·∫£n l√Ω Thanh to√°n

- **ƒêa d·∫°ng ph∆∞∆°ng th·ª©c thanh to√°n**: H·ªó tr·ª£ th·∫ª t√≠n d·ª•ng, chuy·ªÉn kho·∫£n, v√≠ ƒëi·ªán t·ª≠, COD
- **X·ª≠ l√Ω thanh to√°n an to√†n**: Tu√¢n th·ªß PCI DSS v√† ti√™u chu·∫©n b·∫£o m·∫≠t
- **L·ªãch s·ª≠ giao d·ªãch v√† ho√†n ti·ªÅn**: Theo d√µi ƒë·∫ßy ƒë·ªß c√°c giao d·ªãch t√†i ch√≠nh
- **H·ªó tr·ª£ tr·∫£ g√≥p v√† thanh to√°n m·ªôt ph·∫ßn**: Linh ho·∫°t trong c√°c ph∆∞∆°ng th·ª©c thanh to√°n
- **X√°c th·ª±c thanh to√°n**: T√≠ch h·ª£p 3D Secure v√† c√°c ph∆∞∆°ng th·ª©c x√°c th·ª±c hi·ªán ƒë·∫°i

> **_Ch√∫ th√≠ch:_** _H·ªá th·ªëng thanh to√°n s·∫Ω ƒë∆∞·ª£c thi·∫øt k·∫ø v·ªõi t√≠nh m·ªü r·ªông cao, cho ph√©p th√™m m·ªõi c√°c c·ªïng thanh to√°n d·ªÖ d√†ng._

### 2.6. Qu·∫£n l√Ω ƒê∆°n h√†ng

- **Quy tr√¨nh x·ª≠ l√Ω ƒë∆°n h√†ng linh ho·∫°t**: T√πy ch·ªânh quy tr√¨nh theo nhu c·∫ßu kinh doanh
- **Tr·∫°ng th√°i ƒë∆°n h√†ng t√πy ch·ªânh**: T·∫°o v√† qu·∫£n l√Ω c√°c tr·∫°ng th√°i ƒë∆°n h√†ng theo y√™u c·∫ßu
- **L·ªãch s·ª≠ thay ƒë·ªïi ƒë∆°n h√†ng**: Theo d√µi m·ªçi thay ƒë·ªïi trong v√≤ng ƒë·ªùi ƒë∆°n h√†ng
- **ƒê∆°n h√†ng d·ª± tr·ªØ v√† ƒë·∫∑t tr∆∞·ªõc**: H·ªó tr·ª£ ƒë·∫∑t h√†ng tr∆∞·ªõc khi s·∫£n ph·∫©m c√≥ s·∫µn
- **B√°n h√†ng ch√©o v√† b√°n th√™m**: ƒê·ªÅ xu·∫•t s·∫£n ph·∫©m li√™n quan khi ƒë·∫∑t h√†ng

> **_Ch√∫ th√≠ch:_** _Module ƒë∆°n h√†ng l√† trung t√¢m c·ªßa h·ªá th·ªëng, t√≠ch h·ª£p v·ªõi t·∫•t c·∫£ c√°c module kh√°c ƒë·ªÉ cung c·∫•p tr·∫£i nghi·ªám xuy√™n su·ªët._

### 2.7. Khuy·∫øn m√£i & Gi·∫£m gi√°

- **M√£ gi·∫£m gi√° v√† voucher**: T·∫°o v√† qu·∫£n l√Ω c√°c m√£ gi·∫£m gi√° v·ªõi nhi·ªÅu ƒëi·ªÅu ki·ªán
- **Ch∆∞∆°ng tr√¨nh khuy·∫øn m√£i theo th·ªùi gian**: L√™n l·ªãch khuy·∫øn m√£i t·ª± ƒë·ªông
- **Gi·∫£m gi√° theo nh√≥m kh√°ch h√†ng**: Gi√° ƒë·∫∑c bi·ªát cho kh√°ch h√†ng VIP
- **Gi·∫£m gi√° theo s·ªë l∆∞·ª£ng**: Gi·∫£m gi√° khi mua s·ªë l∆∞·ª£ng l·ªõn
- **Qu√† t·∫∑ng v√† s·∫£n ph·∫©m k√®m theo**: Th√™m s·∫£n ph·∫©m qu√† t·∫∑ng v√†o ƒë∆°n h√†ng

> **_Ch√∫ th√≠ch:_** _H·ªá th·ªëng khuy·∫øn m√£i ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ h·ªó tr·ª£ c√°c chi·∫øn d·ªãch marketing ph·ª©c t·∫°p v·ªõi nhi·ªÅu quy t·∫Øc k·∫øt h·ª£p._

### 2.8. N·ªôi dung & Marketing

- **Blog v√† b√†i vi·∫øt**: H·ªá th·ªëng qu·∫£n l√Ω n·ªôi dung t√≠ch h·ª£p
- **Landing page v√† banner qu·∫£ng c√°o**: T·∫°o v√† qu·∫£n l√Ω c√°c trang ƒë√≠ch cho chi·∫øn d·ªãch
- **SEO tools v√† metadata**: T·ªëi ∆∞u h√≥a n·ªôi dung cho c√¥ng c·ª• t√¨m ki·∫øm
- **Email marketing templates**: T·∫°o v√† g·ª≠i email marketing t·ª´ h·ªá th·ªëng
- **ƒê√°nh gi√° v√† b√¨nh lu·∫≠n s·∫£n ph·∫©m**: Thu th·∫≠p ph·∫£n h·ªìi c·ªßa kh√°ch h√†ng

> **_Ch√∫ th√≠ch:_** _Module n√†y s·∫Ω cung c·∫•p c√°c c√¥ng c·ª• ƒë·ªÉ qu·∫£n l√Ω n·ªôi dung v√† t·ªëi ∆∞u h√≥a SEO m·ªôt c√°ch hi·ªáu qu·∫£._

### 2.9. Nh√¢n vi√™n & Ph√¢n quy·ªÅn

- **Qu·∫£n l√Ω ng∆∞·ªùi d√πng v√† vai tr√≤**: T·∫°o v√† qu·∫£n l√Ω t√†i kho·∫£n nh√¢n vi√™n
- **Ph√¢n quy·ªÅn chi ti·∫øt theo ch·ª©c nƒÉng**: Ki·ªÉm so√°t quy·ªÅn truy c·∫≠p ƒë·∫øn c·∫•p ƒë·ªô h√†nh ƒë·ªông
- **Theo d√µi ho·∫°t ƒë·ªông ng∆∞·ªùi d√πng**: Ghi l·∫°i m·ªçi thay ƒë·ªïi v√† h√†nh ƒë·ªông trong h·ªá th·ªëng
- **X√°c th·ª±c hai l·ªõp**: TƒÉng c∆∞·ªùng b·∫£o m·∫≠t cho t√†i kho·∫£n quan tr·ªçng
- **Gi·ªõi h·∫°n theo IP v√† th·ªùi gian**: Ki·ªÉm so√°t th·ªùi gian v√† ƒë·ªãa ƒëi·ªÉm truy c·∫≠p

> **_Ch√∫ th√≠ch:_** _H·ªá th·ªëng ph√¢n quy·ªÅn s·∫Ω ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ linh ho·∫°t v√† chi ti·∫øt, cho ph√©p t·∫°o c√°c vai tr√≤ t√πy ch·ªânh theo nhu c·∫ßu c·ª• th·ªÉ c·ªßa doanh nghi·ªáp._

---

## 3. KI·∫æN TR√öC & C√îNG NGH·ªÜ

### 3.1. Stack C√¥ng ngh·ªá

- **Backend**: ASP.NET Core 6+
- **Frontend**: Angular 16+ (project `zylpelox-zpx-ui`)
- **Database**: SQL Server
- **Cache**: Redis + HybridCache (In-Memory + Distributed)
- **Search (Optional)**: Elasticsearch
- **Message Queue (Optional)**: RabbitMQ

> **_Ch√∫ th√≠ch:_** _Stack ƒë∆∞·ª£c ch·ªçn ƒë·ªÉ ƒë·∫£m b·∫£o hi·ªáu su·∫•t, b·∫£o m·∫≠t, kh·∫£ nƒÉng m·ªü r·ªông v√† h·ªó tr·ª£ c·ªông ƒë·ªìng t·ªët._

### 3.2. Ki·∫øn tr√∫c Ph·∫ßn m·ªÅm

#### 3.2.1. Nguy√™n t·∫Øc c·ªët l√µi

- **Clean Architecture**
  - Domain-centric: ƒê·∫∑t logic nghi·ªáp v·ª• ·ªü trung t√¢m
  - T√°ch bi·ªát c√°c m·ªëi quan t√¢m: Domain, Application, Infrastructure, Presentation
  - Dependency Rule: C√°c ph·ª• thu·ªôc ch·ªâ h∆∞·ªõng v√†o trong (domain core)

> **_Ch√∫ th√≠ch:_** _Clean Architecture gi√∫p t·∫°o ra code d·ªÖ b·∫£o tr√¨, d·ªÖ test v√† ƒë·ªôc l·∫≠p v·ªõi c√°c framework, database hay UI._

- **Domain-Driven Design**
  - Aggregate Roots: X√°c ƒë·ªãnh ranh gi·ªõi nh·∫•t qu√°n c·ªßa d·ªØ li·ªáu
  - Bounded Context: Ph√¢n chia h·ªá th·ªëng th√†nh c√°c ng·ªØ c·∫£nh c√≥ √Ω nghƒ©a
  - Entity v√† Value Objects: Ph√¢n bi·ªát r√µ r√†ng gi·ªØa c√°c ƒë·ªëi t∆∞·ª£ng c√≥ danh t√≠nh v√† kh√¥ng c√≥ danh t√≠nh

> **_Ch√∫ th√≠ch:_** _DDD gi√∫p m√¥ h√¨nh h√≥a c√°c domain ph·ª©c t·∫°p v√† ƒë·∫£m b·∫£o r·∫±ng code ph·∫£n √°nh ƒë√∫ng business rules._

- **Modular Monolith**
  - Kh·∫£ nƒÉng chuy·ªÉn ƒë·ªïi sang Microservices sau n√†y
  - Module separation: T√°ch bi·ªát r√µ r√†ng gi·ªØa c√°c module
  - Shared kernel: Chia s·∫ª c√°c kh√°i ni·ªám chung gi·ªØa c√°c module

> **_Ch√∫ th√≠ch:_** _Modular Monolith l√† l·ª±a ch·ªçn c√¢n b·∫±ng gi·ªØa t√≠nh ƒë∆°n gi·∫£n c·ªßa monolith v√† t√≠nh linh ho·∫°t c·ªßa microservices._

#### 3.2.2. S∆° ƒë·ªì Ki·∫øn tr√∫c T·ªïng th·ªÉ

```mermaid
---
title: T·ªïng th·ªÉ ki·∫øn tr√∫c h·ªá th·ªëng ZPX
---
flowchart LR
    %% Define Nodes
    subgraph UserFacing ["User Facing"]
        direction LR
        USERS["Users<br/>(Web/Mobile)"]
        FRONTEND["zylpelox-zpx-ui<br><span style='font-size:small; opacity:0.8;'>Angular SPA</span>"]
        GATEWAY["API Gateway<br><span style='font-size:small; opacity:0.8;'>Optional</span>"]
    end

    subgraph BackendServices ["Backend Services (ZPX System)"]
        direction TB
        API["ZylPelox.ZPX.Server<br/><span style='font-size:small; opacity:0.8;'>ASP.NET Core API</span>"]
        APP["ZylPelox.ZPX.Application<br/><span style='font-size:small; opacity:0.8;'>Business Logic, CQRS</span>"]
        DOMAIN["ZylPelox.ZPX.Domain<br/><span style='font-size:small; opacity:0.8;'>Entities, Core Logic</span>"]
        INFRA["ZylPelox.ZPX.Infrastructure<br/><span style='font-size:small; opacity:0.8;'>Implementation Details</span>"]
    end

    subgraph ExternalDependencies ["External Dependencies"]
        direction TB
        subgraph Persistence ["Persistence"]
            DB[(SQL Server)]
            CACHE[(Redis Cache)]
            SEARCH[(Elasticsearch)]
        end
        subgraph Messaging ["Messaging"]
             MQ[(RabbitMQ)]
        end
        subgraph ThirdParty ["3rd Party Services"]
             direction TB
             PAYMENT[Payment Service]
             SHIPPING[Shipping Service]
             EMAIL[Email Service]
             OTHER[...]
        end
    end

    %% Define Connections (Following Clean Architecture Dependencies)
    USERS      --> FRONTEND
    FRONTEND   --> GATEWAY
    GATEWAY    --> API

    API        --> APP
    APP        --> DOMAIN
    APP        --> INFRA

    INFRA      --> DB
    INFRA      --> CACHE
    INFRA      --> SEARCH
    INFRA      --> MQ
    INFRA      -.-> PAYMENT
    INFRA      -.-> SHIPPING
    INFRA      -.-> EMAIL
    INFRA      -.-> OTHER

    %% Styling (Optional - makes it visually distinct)
    classDef user fill:#f0f9ff,stroke:#0ea5e9,stroke-width:1px,color:#0369a1;
    classDef backend fill:#fdf2f8,stroke:#db2777,stroke-width:1px,color:#831843;
    classDef external fill:#fefce8,stroke:#ca8a04,stroke-width:1px,color:#713f12;
    classDef db fill:#eff6ff,stroke:#60a5fa,stroke-width:1.5px,color:#1e40af;
    classDef thirdparty fill:#fffbeb,stroke:#f59e0b,stroke-width:1.5px,color:#78350f;

    class USERS,FRONTEND,GATEWAY user;
    class API,APP,DOMAIN,INFRA backend;
    class DB,CACHE,SEARCH,MQ db;
    class PAYMENT,SHIPPING,EMAIL,OTHER thirdparty;

    style UserFacing fill:none,stroke:#0ea5e9,stroke-dasharray: 5 5;
    style BackendServices fill:none,stroke:#db2777,stroke-dasharray: 5 5;
    style ExternalDependencies fill:none,stroke:#ca8a04,stroke-dasharray: 5 5;
    style Persistence fill:none,stroke:#60a5fa,stroke-width:1px;
    style Messaging fill:none,stroke:#60a5fa,stroke-width:1px;
    style ThirdParty fill:none,stroke:#f59e0b,stroke-width:1px;
```

### 3.3. Design Patterns Ch√≠nh

- **CQRS v·ªõi MediatR**
  - Commands (Write): Thay ƒë·ªïi tr·∫°ng th√°i h·ªá th·ªëng
  - Queries (Read): Truy v·∫•n d·ªØ li·ªáu, kh√¥ng thay ƒë·ªïi tr·∫°ng th√°i
  - Notifications (Events): Th√¥ng b√°o s·ª± ki·ªán ƒë·∫øn c√°c handler kh√°c nhau

> **_Ch√∫ th√≠ch:_** _CQRS gi√∫p t√°ch bi·ªát logic ƒë·ªçc v√† ghi, cho ph√©p t·ªëi ∆∞u h√≥a ri√™ng cho m·ªói lo·∫°i, ƒë·∫∑c bi·ªát h·ªØu √≠ch cho h·ªá th·ªëng c√≥ t·ªâ l·ªá ƒë·ªçc/ghi ch√™nh l·ªách._

- **Repository & Specification Pattern**
  - Generic Repository: Interface chung cho vi·ªác truy xu·∫•t d·ªØ li·ªáu
  - Specification abstraction: ƒê√≥ng g√≥i logic truy v·∫•n

> **_Ch√∫ th√≠ch:_** _Repository pattern gi√∫p t√°ch bi·ªát logic truy c·∫≠p d·ªØ li·ªáu kh·ªèi domain logic, trong khi Specification pattern gi√∫p t√°i s·ª≠ d·ª•ng v√† k·∫øt h·ª£p c√°c ƒëi·ªÅu ki·ªán truy v·∫•n._

- **Domain Events**
  - Event publishing: Ph√°t h√†nh s·ª± ki·ªán khi c√≥ thay ƒë·ªïi trong domain
  - Event handling: X·ª≠ l√Ω c√°c t√°c ƒë·ªông ph·ª• do s·ª± ki·ªán g√¢y ra

> **_Ch√∫ th√≠ch:_** _Domain Events cho ph√©p c√°c ph·∫ßn kh√°c nhau c·ªßa h·ªá th·ªëng ph·∫£n ·ª©ng v·ªõi nh·ªØng thay ƒë·ªïi m√† kh√¥ng c·∫ßn k·∫øt n·ªëi tr·ª±c ti·∫øp, gi√∫p gi·∫£m s·ª± ph·ª• thu·ªôc._

### 3.4. Packages & Libraries Ch√≠nh

#### 3.4.1. Backend (.NET)

- **MediatR**: Tri·ªÉn khai CQRS v√† x·ª≠ l√Ω s·ª± ki·ªán
- **FluentValidation**: Validation d·ª±a tr√™n fluent interface
- **AutoMapper**: Mapping gi·ªØa c√°c ƒë·ªëi t∆∞·ª£ng
- **FluentResults**: X·ª≠ l√Ω k·∫øt qu·∫£ v·ªõi nhi·ªÅu tr·∫°ng th√°i
- **Serilog**: Logging c√≥ c·∫•u tr√∫c
- **Ardalis.Specification**: Tri·ªÉn khai pattern Specification
- **EFCore.BulkExtensions**: T·ªëi ∆∞u c√°c thao t√°c h√†ng lo·∫°t
- **BCrypt.Net-Next**: M√£ h√≥a m·∫≠t kh·∫©u
- **Swashbuckle**: T√†i li·ªáu API (Swagger)

> **_Ch√∫ th√≠ch:_** _C√°c th∆∞ vi·ªán ƒë∆∞·ª£c ch·ªçn d·ª±a tr√™n ƒë·ªô tin c·∫≠y, hi·ªáu su·∫•t v√† m·ª©c ƒë·ªô h·ªó tr·ª£ t·ªët t·ª´ c·ªông ƒë·ªìng._

#### 3.4.2. Frontend (Angular)

- **Angular Material**: Th√†nh ph·∫ßn UI
- **NgRx**: Qu·∫£n l√Ω state
- **RxJS**: L·∫≠p tr√¨nh reactive
- **Angular Flex Layout**: Layout ph·∫£n h·ªìi
- **NgxTranslate**: ƒêa ng√¥n ng·ªØ

> **_Ch√∫ th√≠ch:_** _C√°c th∆∞ vi·ªán frontend ƒë∆∞·ª£c ch·ªçn ƒë·ªÉ cung c·∫•p tr·∫£i nghi·ªám ng∆∞·ªùi d√πng nh·∫•t qu√°n v√† hi·ªáu su·∫•t cao._

### 3.5. C·∫•u tr√∫c Solution

```plaintext
üìÅ ZylPelox
 ‚îú‚îÄ‚îÄ üìÅ Core
 ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.Domain                 // Logic nghi·ªáp v·ª• c·ªët l√µi
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Entities                        // C√°c entity c∆° b·∫£n
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Aggregates                      // C√°c aggregate roots
 ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Product
 ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Order
 ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Customer
 ‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Inventory
 ‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ ...
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ JunctionEntities                // Entity m·ªëi quan h·ªá nhi·ªÅu-nhi·ªÅu
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ValueObjects                    // Value objects
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Events                          // Domain events
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Exceptions                      // Domain exceptions
 ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Services                        // Domain services
 ‚îÇ   ‚îÇ
 ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.Application            // Logic ·ª©ng d·ª•ng
 ‚îÇ   ‚îÇ    ‚îú‚îÄ‚îÄ üìÅ Common
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Behaviors                  // Pipeline behaviors (validation, logging)
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Specifications             // Query specifications
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Exceptions                 // Application exceptions
 ‚îÇ   ‚îÇ    ‚îú‚îÄ‚îÄ üìÅ Contracts
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Persistence                // Persistence interfaces
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Repositories           // Repository interfaces
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Infrastructure             // Infrastructure interfaces
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Identity                   // Identity interfaces
 ‚îÇ   ‚îÇ    ‚îú‚îÄ‚îÄ üìÅ Features                       // CQRS features
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Products                   // Product-related commands/queries
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Orders                     // Order-related commands/queries
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Customers                  // Customer-related commands/queries
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Inventory                  // Inventory-related commands/queries
 ‚îÇ   ‚îÇ    ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ ...                        // Other features
 ‚îÇ   ‚îÇ    ‚îî‚îÄ‚îÄ üìÅ EventHandlers                  // Domain event handlers
 |   ‚îÇ
 ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ ZylPelox.ZPX.SharedKernel           // Shared utilities and DTOs
 ‚îÇ       ‚îú‚îÄ‚îÄ üìÅ Constants                       // Shared constants
 ‚îÇ       ‚îú‚îÄ‚îÄ üìÅ Extensions                      // Extension methods
 ‚îÇ       ‚îî‚îÄ‚îÄ üìÅ Utilities                       // Utility classes
 ‚îÇ
 ‚îú‚îÄ‚îÄ üìÅ Infrastructure
 ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.Infrastructure         // D·ªãch v·ª• c∆° s·ªü h·∫° t·∫ßng
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Cache                           // Caching implementation
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Email                           // Email service
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ FileStorage                     // File storage service
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ MessageBroker                   // Message broker integration
 ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ ThirdPartyServices              // Third-party integrations
 ‚îÇ   ‚îÇ
 ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.Persistence            // Truy c·∫≠p d·ªØ li·ªáu
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Configurations                  // EF Core configurations
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Repositories                    // Repository implementations
 ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Migrations                      // Database migrations
 ‚îÇ   ‚îÇ
 ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ ZylPelox.ZPX.Identity               // X√°c th·ª±c v√† ph√¢n quy·ªÅn
 ‚îÇ       ‚îú‚îÄ‚îÄ üìÅ Models                          // Identity models
 ‚îÇ       ‚îú‚îÄ‚îÄ üìÅ Services                        // Identity services
 ‚îÇ       ‚îî‚îÄ‚îÄ üìÅ Configurations                  // Identity configurations
 ‚îÇ
 ‚îú‚îÄ‚îÄ üìÅ Presentation
 ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.Server                 // Web API
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Controllers                     // API controllers
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Filters                         // Action filters
 ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ Middleware                      // Custom middleware
 ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ Configurations                  // API configurations
 ‚îÇ   ‚îÇ
 ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ ZylPelox.ZPX.UI                     // Angular frontend
 ‚îÇ       ‚îú‚îÄ‚îÄ üìÅ src
 ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ app
 ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ core                    // Core functionality
 ‚îÇ       ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ shared                  // Shared components
 ‚îÇ       ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ features                // Feature modules
 ‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ üìÅ assets                      // Static assets
 ‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ üìÅ environments                // Environment configurations
 ‚îÇ       ‚îî‚îÄ‚îÄ üìÅ angular.json                    // Angular configuration
 ‚îÇ
 ‚îî‚îÄ‚îÄ üìÅ Tests                                   // Tests
     ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.UnitTests              // Unit tests
     ‚îú‚îÄ‚îÄ üìÅ ZylPelox.ZPX.IntegrationTests       // Integration tests
     ‚îî‚îÄ‚îÄ üìÅ ZylPelox.ZPX.E2ETests               // End-to-end tests
```

> _**Ch√∫ th√≠ch:**_ _C·∫•u tr√∫c tu√¢n theo Clean Architecture, ph·ª• thu·ªôc h∆∞·ªõng v√†o Core._

---

## 4. THI·∫æT K·∫æ CHI TI·∫æT

### 4.1. Domain Design

- **Entities & Base Classes**: `BaseEntity` (Guid Id), `BaseAuditableEntity` (th√™m CreatedAt, CreatedBy, LastModifiedAt, LastModifiedBy, IsDeleted...).
- **Aggregate Roots**: Product, Order, Customer, Inventory, Promotion (qu·∫£n l√Ω c√°c entity li√™n quan nh∆∞ m·ªôt ƒë∆°n v·ªã nh·∫•t qu√°n).
- **Junction/Intermediate Entities**: ProductCategory, ProductTag, OrderDiscount... (qu·∫£n l√Ω quan h·ªá N-N).
- **Value Objects**: Money, Address, DateRange, ContactInformation... (b·∫•t bi·∫øn, ƒë·ªãnh nghƒ©a b·ªüi thu·ªôc t√≠nh).
- **Domain Services**: OrderProcessingService, PricingService... (ch·ª©a logic nghi·ªáp v·ª• ph·ª©c t·∫°p kh√¥ng thu·ªôc entity n√†o).
- **Domain Events**: OrderPlacedEvent, PaymentReceivedEvent... (th√¥ng b√°o c√°c thay ƒë·ªïi quan tr·ªçng).

### 4.2. Application Layer Details

- **CQRS Implementation**: Commands (CreateProductCommand...), Queries (GetProductsQuery...), Handlers t∆∞∆°ng ·ª©ng.
- **DTOs & Mapping**: Request DTOs (CreateProductRequest...), Response DTOs (ProductDto...), Mapping Profiles (AutoMapper).
- **Validation**: Validators (CreateProductValidator...) v·ªõi FluentValidation, Validation Behavior (MediatR Pipeline).
- **Application Services Interfaces**: IEmailService, IFileStorageService, ICacheService... (ƒë·ªãnh nghƒ©a contracts cho infrastructure).

### 4.3. API Design & Endpoints

- **Nguy√™n t·∫Øc RESTful**: Resource-based URLs, HTTP methods ƒë√∫ng, status codes ph√π h·ª£p, h·ªó tr·ª£ Paging/Filtering/Sorting.
- **API Versioning**: URL-based (`/api/v1/...`).
- **API Documentation**: T√≠ch h·ª£p Swagger/OpenAPI, v√≠ d·ª• request/response, changelog.
- **Controller Example**:

    ```csharp
    [ApiController]
    [Route("api/v1/[controller]")]
    public class ProductsController : ControllerBase // K·∫ø th·ª´a t·ª´ ControllerBase ho·∫∑c BaseApiController t√πy ch·ªânh
    {
        private readonly IMediator _mediator; // Ho·∫∑c ISender/IPublisher

        public ProductsController(IMediator mediator) => _mediator = mediator;

        [HttpGet]
        [ProducesResponseType(typeof(PaginatedList<ProductDto>), StatusCodes.Status200OK)]
        public async Task<IActionResult> GetProducts([FromQuery] GetProductsQuery query)
        {
            var result = await _mediator.Send(query);
            // C√≥ th·ªÉ th√™m x·ª≠ l√Ω l·ªói chung ho·∫∑c tr·∫£ v·ªÅ Ok tr·ª±c ti·∫øp n·∫øu d√πng middleware/filter
            return Ok(result);
        }

        // ... c√°c endpoints kh√°c (GET by Id, POST, PUT, DELETE) v·ªõi x·ª≠ l√Ω l·ªói v√† tr·∫£ v·ªÅ ActionResult ph√π h·ª£p
    }
    ```

### 4.4. Database Design

#### 4.4.1. T·ªïng quan Schema

- Nh√≥m b·∫£ng li√™n quan ƒë·∫øn Product (Products, Categories, Brands, ProductImages...).
- Nh√≥m b·∫£ng li√™n quan ƒë·∫øn Order (Orders, OrderItems, OrderStatuses...).
- Nh√≥m b·∫£ng li√™n quan ƒë·∫øn Customer (Customers, Addresses...).
- Nh√≥m b·∫£ng Inventory (Inventory, Warehouses, InventoryHistory...).
- Nh√≥m b·∫£ng Identity (AspNetUsers, AspNetRoles...).
- Nh√≥m b·∫£ng Marketing (Discounts...).
- Nh√≥m b·∫£ng Reviews (ProductReviews...).
- B·∫£ng trung gian (Junction tables).

#### 4.4.2. S∆° ƒë·ªì Quan h·ªá Th·ª±c th·ªÉ (ERD)

```mermaid
---
title: ERD (Entity Relationship Diagram) cho database
---

erDiagram
    CUSTOMER ||--o{ ORDER : places
    CUSTOMER ||--o{ ADDRESS : has
    PRODUCT ||--o{ PRODUCT_VARIANT : has
    PRODUCT }o--o{ PRODUCT_CATEGORY : "in (via junction)"
    %% Many-to-Many requires junction table PRODUCT_CATEGORY
    CATEGORY }o--o{ PRODUCT_CATEGORY : "contains (via junction)"

    ORDER ||--o{ ORDER_ITEM : includes
    PRODUCT_VARIANT ||--o{ ORDER_ITEM : ordered

    CUSTOMER {
      GUID Id PK "Primary Key"
      string Name
      string Email "Unique identifier"
      datetime CreatedAt
      datetime UpdatedAt
    }
    ADDRESS {
      GUID Id PK
      GUID CustomerId FK "Links to CUSTOMER"
      string Line1
      string Line2 "Optional"
      string City
      string PostalCode
      string Country
      bool IsDefault
    }
    PRODUCT {
      GUID Id PK
      string Name
      string Description "Optional"
      string SKU "Base SKU"
      decimal Price "Default price if no variants"
      datetime CreatedAt
      datetime UpdatedAt
    }
    PRODUCT_VARIANT {
      GUID Id PK
      GUID ProductId FK "Links to PRODUCT"
      string SKU "Unique Variant SKU"
      string AttributesJSON "Optional, e.g., {'Color': 'Red', 'Size': 'L'}"
      decimal Price "Specific variant price"
      int StockQuantity
      datetime CreatedAt
      datetime UpdatedAt
    }
    CATEGORY {
      GUID Id PK
      string Name
      string Slug "URL-friendly name"
      GUID ParentCategoryId FK "Optional, For sub-categories"
      datetime CreatedAt
      datetime UpdatedAt
    }
    %% Junction table for Many-to-Many between Product and Category
    PRODUCT_CATEGORY {
      GUID ProductId FK "Links to PRODUCT"
      GUID CategoryId FK "Links to CATEGORY"
      %% Composite Primary Key (ProductId, CategoryId) typically handled by DB constraint
    }
    "ORDER" {
      GUID Id PK
      GUID CustomerId FK "Links to CUSTOMER"
      string OrderNumber "User-friendly identifier"
      datetime OrderDate
      string Status "e.g., Pending, Processing, Shipped, Delivered, Cancelled"
      decimal TotalAmount
      datetime CreatedAt
      datetime UpdatedAt
    }
    ORDER_ITEM {
      GUID Id PK
      GUID OrderId FK "Links to ORDER"
      GUID ProductVariantId FK "Links to PRODUCT_VARIANT"
      int Quantity
      decimal UnitPrice "Price at time of order"
      decimal TotalPrice
    }
```

> _**Ch√∫ th√≠ch:**_ _ƒê√¢y l√† ERD gi·∫£n l∆∞·ª£c c√°c th·ª±c th·ªÉ v√† m·ªëi quan h·ªá ch√≠nh. Xem **Ph·ª• l·ª•c B** ƒë·ªÉ c√≥ chi ti·∫øt ƒë·∫ßy ƒë·ªß v·ªÅ schema._

#### 4.4.3. Entity Framework Core Configuration Example

```csharp
public class ProductConfiguration : IEntityTypeConfiguration<Product>
{
    public void Configure(EntityTypeBuilder<Product> builder)
    {
        builder.ToTable("Products"); // ƒê·∫∑t t√™n b·∫£ng r√µ r√†ng
        builder.HasKey(p => p.Id);

        builder.Property(p => p.Name).IsRequired().HasMaxLength(200);
        builder.Property(p => p.Price).HasColumnType("decimal(18,2)"); // ƒê·ªãnh nghƒ©a ki·ªÉu d·ªØ li·ªáu DB

        // Quan h·ªá v·ªõi Variants
        builder.HasMany(p => p.Variants)
               .WithOne(v => v.Product)
               .HasForeignKey(v => v.ProductId)
               .OnDelete(DeleteBehavior.Cascade); // Ho·∫∑c Restrict t√πy logic nghi·ªáp v·ª•

        // Quan h·ªá v·ªõi Category (1-N)
        builder.HasOne(p => p.Category)
               .WithMany(c => c.Products)
               .HasForeignKey(p => p.CategoryId)
               .OnDelete(DeleteBehavior.SetNull); // Ho·∫∑c Restrict

        // C·∫•u h√¨nh Index
        builder.HasIndex(p => p.Name);
        builder.HasIndex(p => p.Sku).IsUnique(); // N·∫øu SKU l√† duy nh·∫•t

        // C·∫•u h√¨nh Soft Delete Filter
        builder.HasQueryFilter(p => !p.IsDeleted);
    }
}
```

#### 4.4.4. Migration Strategy

- Code-First approach, Incremental migrations, Schema versioning, Data seeding cho lookup tables.

#### 4.4.5. Performance Considerations

- Indexing ph√π h·ª£p, Batch operations (BulkExtensions), T·ªëi ∆∞u truy v·∫•n ƒë·ªçc (CQRS), Tr√°nh N+1 problem (Eager/Explicit loading).

### 4.5. Frontend Architecture (`ZylPelox.ZPX.UI`)

- **Terminal**: ng new zylpelox-zpx-ui --routing --style=scss --skip-git --package-manager=npm --directory=src/Presentation/ZylPelox.ZPX.UI
- **C·∫•u tr√∫c**: Core Module, Shared Module, Feature Modules (lazy-loaded).
- **State Management**: NgRx (cho state ph·ª©c t·∫°p/to√†n c·ª•c), Services + RxJS (cho state ƒë∆°n gi·∫£n), Local component state.
- **UI Components**: Base tr√™n Angular Material, Custom components m·ªü r·ªông, Responsive (Flex Layout).
- **Routing & Navigation**: Feature-based, Route Guards, Lazy-loading.
- **Internationalization (I18n)**: NgxTranslate, ƒë·ªãnh d·∫°ng currency/date theo locale, h·ªó tr·ª£ RTL.
- **Tailwind CSS**: S·ª≠ d·ª•ng Tailwind CSS cho styling, Responsive design, Utility-first approach.

---

## 5. C√ÅC V·∫§N ƒê·ªÄ XUY√äN SU·ªêT (CROSS-CUTTING CONCERNS)

### 5.1. Error Handling & Logging

- **Exception Handling**: Custom domain exceptions with prefix name [Zpx]NameExceptions.cs (`ZpxNotFoundException`...), Global exception middleware, Structured error responses.
- **Logging Strategy**: Structured logging (Serilog), Log levels, Log enrichment, Log storage/rotation.
- **Monitoring**: Health checks, Application metrics, Performance counters, API usage statistics.

### 5.2. Security Considerations

- **Authentication & Authorization**: JWT, Role-based, Policy-based, Refresh token strategy.
- **Data Protection**: HTTPS, Encryption (at rest/in transit), Input validation/sanitization, CSRF protection.
- **API Security**: Rate limiting, Request validation, API keys, CORS configuration.

### 5.3. Caching Strategy

- **Cache Levels**: Memory cache (L1), Distributed cache - Redis (L2), Browser caching.
- **Cache Invalidation**: Time-based, Event-based, Cache dependencies.
- **Cacheable Resources**: Product catalog, User preferences, Lookup data, Session data.

### 5.4. E2ETests

- **End-to-End Testing**: Cypress, Test critical user flows, UI/UX validation, API contract tests.
- **Test Scenarios**: User registration, Product search, Order placement, Payment processing, Admin operations.

### 5.5. Registration Service

- **Name Static class**: [ProjectName]ServiceRegistration.cs
- **Register Services**: Use `IServiceCollection` to register all services, repositories, and configurations.

---

## 6. QUY TR√åNH PH√ÅT TRI·ªÇN & V·∫¨N H√ÄNH

### 6.1. Testing Approach

- **Unit Testing**: Domain logic, Application handlers, Services (xUnit, Moq).
- **Integration Testing**: Repositories, API endpoints, Database interactions (xUnit, TestContainers/In-Memory DB).
- **E2E Testing**: Critical user flows, UI/UX (Cypress/Playwright).

### 6.2. Deployment & DevOps

- **CI/CD Pipeline**: Automated builds (GitHub Actions/Azure DevOps), automated testing, static code analysis, deployment automation.
- **Environments**: Development, Testing/QA, Staging, Production.
- **Deployment Strategy**: Docker containerization, Azure App Service/Kubernetes, Blue-green/Canary deployment.

### 6.3. Coding Standards & Quality

- **Naming Conventions**: Nh·∫•t qu√°n (DTOs, Specs, Exceptions...).
- **Code Quality Tools**: SonarLint/SonarQube, StyleCop, EditorConfig, Quality gates in CI/CD.
- **Documentation**: Code comments (XML Doc), Architecture docs, API docs (Swagger), User guides.
- **Development Practices**: Code reviews, Pull request workflow, Feature branch strategy, TDD (khi ph√π h·ª£p).

---

## 7. QU·∫¢N L√ù D·ª∞ √ÅN

### 7.1. Roadmap & Phasing

- **Phase 0: Planning & Setup (Month 0)**: X√°c ƒë·ªãnh y√™u c·∫ßu chi ti·∫øt, Thi·∫øt l·∫≠p m√¥i tr∆∞·ªùng ph√°t tri·ªÉn, Ki·∫øn tr√∫c t·ªïng th·ªÉ.
- **Phase 1: MVP (Month 1-3)**: Catalog, Order c∆° b·∫£n, Customer accounts, Admin dashboard, 1-2 Payment providers.
- **Phase 2: Enhanced Features (Month 4-6)**: Inventory, Advanced search, Promotions, Reviews, Th√™m payment options.
- **Phase 3: Advanced Features (Month 7-9)**: Analytics, Marketing tools, Multi-vendor (opt), Mobile app (opt), 3rd Party API.
- **Phase 4: Optimization & Scaling (Month 10+)**: Performance tuning, Security hardening, Scalability improvements, Monitoring setup.
- **Phase 5: Maintenance & Support (Ongoing)**: Bug fixes, Feature requests, Technical debt management, Regular updates.
- **Phase 6: Review & Retrospective (Ongoing)**: ƒê√°nh gi√° quy tr√¨nh ph√°t tri·ªÉn, H·ªçc h·ªèi t·ª´ c√°c v·∫•n ƒë·ªÅ g·∫∑p ph·∫£i, C·∫£i ti·∫øn quy tr√¨nh.
- **Phase 7: Future Planning (Ongoing)**: L√™n k·∫ø ho·∫°ch cho c√°c t√≠nh nƒÉng m·ªõi, C·∫≠p nh·∫≠t c√¥ng ngh·ªá, M·ªü r·ªông h·ªá th·ªëng.
- **Phase 8: Community Engagement (Ongoing)**: T∆∞∆°ng t√°c v·ªõi c·ªông ƒë·ªìng ng∆∞·ªùi d√πng, Thu th·∫≠p ph·∫£n h·ªìi, C·∫£i ti·∫øn d·ª±a tr√™n nhu c·∫ßu th·ª±c t·∫ø.
- **Phase 9: Documentation & Training (Ongoing)**: C·∫≠p nh·∫≠t t√†i li·ªáu, H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng, ƒê√†o t·∫°o cho ng∆∞·ªùi d√πng v√† nh√† ph√°t tri·ªÉn m·ªõi.
- **Phase 10: Long-term Support (LTS) Planning (Ongoing)**: L√™n k·∫ø ho·∫°ch cho c√°c phi√™n b·∫£n h·ªó tr·ª£ l√¢u d√†i, B·∫£o tr√¨ v√† c·∫≠p nh·∫≠t ƒë·ªãnh k·ª≥.
- **Phase 11: Scalability & Performance Enhancements (Ongoing)**: T·ªëi ∆∞u h√≥a hi·ªáu su·∫•t, M·ªü r·ªông quy m√¥ h·ªá th·ªëng, C·∫£i ti·∫øn ki·∫øn tr√∫c khi c·∫ßn thi·∫øt.
- **Phase 12: Innovation & New Features (Ongoing)**: Nghi√™n c·ª©u c√¥ng ngh·ªá m·ªõi, Th√™m c√°c t√≠nh nƒÉng s√°ng t·∫°o, C·∫≠p nh·∫≠t theo xu h∆∞·ªõng th·ªã tr∆∞·ªùng.
- **Phase 13: Community Contributions (Ongoing)**: Khuy·∫øn kh√≠ch c·ªông ƒë·ªìng ƒë√≥ng g√≥p m√£ ngu·ªìn, T√≠ch h·ª£p c√°c t√≠nh nƒÉng t·ª´ c·ªông ƒë·ªìng, Qu·∫£n l√Ω pull requests.
- **Phase 14: Legacy Code Management (Ongoing)**: Qu·∫£n l√Ω m√£ ngu·ªìn c≈©, C·∫£i ti·∫øn v√† refactor khi c·∫ßn thi·∫øt, ƒê·∫£m b·∫£o t√≠nh t∆∞∆°ng th√≠ch ng∆∞·ª£c.
- **Phase 15: Compliance & Legal Considerations (Ongoing)**: ƒê·∫£m b·∫£o tu√¢n th·ªß c√°c quy ƒë·ªãnh ph√°p l√Ω, B·∫£o v·ªá d·ªØ li·ªáu ng∆∞·ªùi d√πng, Qu·∫£n l√Ω gi·∫•y ph√©p ph·∫ßn m·ªÅm.
- Use **Agile/Scrum**: Sprints, Backlog grooming, Daily standups, Sprint reviews/retrospectives.

### 7.2. Resource Requirements & Timeline

#### 7.2.1. Development Team

- 1 Tech Lead/Architect, 3-4 Backend Devs, 2 Frontend Devs, 1 QA Engineer, 1 DevOps (part-time).

#### 7.2.2. Infrastructure

- Dev, Test/QA, Staging, Production environments, CI/CD pipeline, Source control.

#### 7.2.3. Estimated Timeline

- Planning & Setup: 2-3 weeks
- MVP Development: 2-3 months
- Testing & Refinement: 1 month
- Enhanced Features: 3 months
- Advanced Features: 3 months

---

## 8. PH·ª§ L·ª§C

### Ph·ª• l·ª•c A: Diagram Quy tr√¨nh Nghi·ªáp v·ª•

#### A.1. Sequence Diagram: Lu·ªìng "ƒê·∫∑t h√†ng" (Order Placement)

```mermaid
---
title: Lu·ªìng "ƒê·∫∑t h√†ng" (Order Placement)
---
sequenceDiagram
    actor User
    participant FE as "Frontend (ui)"
    participant GW as "API Gateway (Optional)"
    participant API as "API Server (Server)"
    participant APP as "Application (Application)"
    participant DM as "Domain (Domain)"
    participant DB as "Persistence (Persistence)"
    participant PAY as "Payment Service (Infrastructure)"
    participant EMAIL as "Email Service (Infrastructure)"

    User->>+FE: 1. Ch·ªçn s·∫£n ph·∫©m, ƒëi·ªÅn th√¥ng tin, nh·∫•n "ƒê·∫∑t h√†ng"
    FE->>+GW: 2. POST /api/v1/orders (Auth Token, Order Data)
    GW->>+API: 3. Forward POST /api/v1/orders
    API->>+APP: 4. Execute CreateOrderCommand (CQRS)
    APP->>+DM: 5. Validate Order Data (Business Rules)
    DM-->>-APP: 6. Validation Result (Success/Fail)
    alt Order is Valid
        APP->>DM: 7. Create Order Aggregate (Entities: Order, OrderItems)
        APP->>+DB: 8. SaveChangesAsync() (Unit of Work Pattern)
        DB-->>-APP: 9. Order Saved (ID generated)
        APP->>+PAY: 10. ProcessPayment(OrderId, Amount, PaymentDetails)
        PAY-->>-APP: 11. PaymentResult (Success/Fail)
        alt Payment Successful
            APP->>+DB: 12. Update Order Status ('Processing' or 'Paid')
            DB-->>-APP: 13. Status Updated
            APP->> DM: 14. Raise OrderPlaced Domain Event
            APP->>+EMAIL: 15. SendOrderConfirmationEmail(OrderId, CustomerEmail)
            EMAIL-->>-APP: 16. Email Queued/Sent
            APP-->>API: 17. Order Creation Success (Order Details)
        else Payment Failed
            APP->>+DB: 12a. Update Order Status ('PaymentFailed')
            DB-->>-APP: 13a. Status Updated
            APP-->>API: 17a. Order Creation Failed (Payment Error)
        end
    else Order is Invalid
         APP-->>API: 17b. Order Creation Failed (Validation Errors)
    end
    API-->>-GW: 18. API Response
    GW-->>-FE: 19. Forward API Response
    FE->>-User: 20. Hi·ªÉn th·ªã tr·∫°ng th√°i ƒë·∫∑t h√†ng (Success/Error Message)
```

#### A.2. Sequence Diagram: Lu·ªìng "Qu·∫£n l√Ω t·ªìn kho t·ª± ƒë·ªông" (Auto Inventory Adjustment)

```mermaid
---
title: Lu·ªìng "Qu·∫£n l√Ω t·ªìn kho t·ª± ƒë·ªông" (Auto Inventory Adjustment via Domain Event)
---
sequenceDiagram
    participant APP as "Application Layer (Order Service Context)"
    participant DM as "Domain Layer"
    participant DB as "Persistence (Persistence)"
    participant MQ as "Event Bus (e.g., RabbitMQ via Infrastructure)"
    participant InventoryHandler as "InventoryEventHandler (App Layer - Inventory Context)"
    participant Notify as "NotificationService (Infrastructure)"
    participant Admin as "Admin User/System"

    Note over APP, DB: Order has been successfully placed and saved.
    APP->>+DM: 1. Raise OrderPlaced Domain Event
    DM-->>-APP: (Event raised within Domain)

    Note over APP, MQ: Application Layer (or Domain Event Dispatcher) handles publishing events.
    APP->>+MQ: 2. Publish(OrderPlacedEvent)

    Note right of MQ: Event Bus delivers event to interested subscribers.
    MQ->>+InventoryHandler: 3. Receive(OrderPlacedEvent)

    InventoryHandler->>+DB: 4. Get ProductVariant data for OrderItems
    DB-->>-InventoryHandler: 5. ProductVariant details (incl. current stock)

    loop For Each OrderItem in Event
        InventoryHandler->>InventoryHandler: 6. Calculate new stock level
        InventoryHandler->>+DB: 7. Update ProductVariant Stock (e.g., Stock = Stock - Quantity)
        DB-->>-InventoryHandler: 8. Stock updated
        alt Stock Level is Low (below threshold)
            InventoryHandler->>+MQ: 9. Publish(LowStockDetectedEvent)
            MQ->>+Notify: 10. Receive(LowStockDetectedEvent)
            Notify->>Admin: 11. Send Low Stock Notification (Email, SMS, etc.)
        end
    end
    InventoryHandler-->>-MQ: (Processing Complete)
```

### Ph·ª• l·ª•c B: Chi ti·∫øt Schema Database

> **Ng√†y hi·ªán t·∫°i:** 2024-06-15 19:10:01
> **Ng∆∞·ªùi d√πng:** phamtiendungcw

#### T·ªïng quan c√°c nh√≥m b·∫£ng

1. **Identity Tables** - Qu·∫£n l√Ω ng∆∞·ªùi d√πng v√† x√°c th·ª±c
2. **Core eCommerce Tables** - S·∫£n ph·∫©m, danh m·ª•c, ƒë∆°n h√†ng
3. **Customer Management Tables** - Kh√°ch h√†ng, ƒë·ªãa ch·ªâ
4. **Inventory & Stock Tables** - Qu·∫£n l√Ω h√†ng t·ªìn kho
5. **Review & Rating Tables** - ƒê√°nh gi√° s·∫£n ph·∫©m
6. **Marketing Tables** - Khuy·∫øn m√£i, m√£ gi·∫£m gi√°
7. **Logging & Audit Tables** - Ghi log h·ªá th·ªëng

#### Identity Tables

##### 1. AspNetUsers (B·∫£ng Identity m·∫∑c ƒë·ªãnh)

| Column Name          | Data Type      | Constraints | Description             |
| -------------------- | -------------- | ----------- | ----------------------- |
| Id                   | nvarchar(450)  | PK          | ƒê·ªãnh danh ng∆∞·ªùi d√πng    |
| UserName             | nvarchar(256)  |             | T√™n ƒëƒÉng nh·∫≠p           |
| NormalizedUserName   | nvarchar(256)  | INDEX       | T√™n ƒëƒÉng nh·∫≠p chu·∫©n h√≥a |
| Email                | nvarchar(256)  |             | Email                   |
| NormalizedEmail      | nvarchar(256)  | INDEX       | Email chu·∫©n h√≥a         |
| EmailConfirmed       | bit            |             | Email ƒë√£ x√°c nh·∫≠n       |
| PasswordHash         | nvarchar(max)  |             | M·∫≠t kh·∫©u ƒë√£ hash        |
| SecurityStamp        | nvarchar(max)  |             | D√πng cho b·∫£o m·∫≠t        |
| ConcurrencyStamp     | nvarchar(max)  |             | Ki·ªÉm so√°t ƒë·ªìng th·ªùi     |
| PhoneNumber          | nvarchar(max)  |             | S·ªë ƒëi·ªán tho·∫°i           |
| PhoneNumberConfirmed | bit            |             | SƒêT ƒë√£ x√°c nh·∫≠n         |
| TwoFactorEnabled     | bit            |             | X√°c th·ª±c 2 y·∫øu t·ªë       |
| LockoutEnd           | datetimeoffset |             | Th·ªùi gian kh√≥a h·∫øt h·∫°n  |
| LockoutEnabled       | bit            |             | Kh√≥a t√†i kho·∫£n          |
| AccessFailedCount    | int            |             | S·ªë l·∫ßn ƒëƒÉng nh·∫≠p sai    |
| FirstName            | nvarchar(100)  |             | T√™n                     |
| LastName             | nvarchar(100)  |             | H·ªç                      |
| ProfilePictureUrl    | nvarchar(500)  |             | URL ·∫£nh ƒë·∫°i di·ªán        |

##### 2. AspNetRoles

| Column Name      | Data Type     | Constraints | Description           |
| ---------------- | ------------- | ----------- | --------------------- |
| Id               | nvarchar(450) | PK          | ƒê·ªãnh danh vai tr√≤     |
| Name             | nvarchar(256) |             | T√™n vai tr√≤           |
| NormalizedName   | nvarchar(256) | INDEX       | T√™n vai tr√≤ chu·∫©n h√≥a |
| ConcurrencyStamp | nvarchar(max) |             | Ki·ªÉm so√°t ƒë·ªìng th·ªùi   |

##### 3. AspNetUserRoles

| Column Name | Data Type     | Constraints | Description   |
| ----------- | ------------- | ----------- | ------------- |
| UserId      | nvarchar(450) | PK, FK      | ID ng∆∞·ªùi d√πng |
| RoleId      | nvarchar(450) | PK, FK      | ID vai tr√≤    |

##### 4. AspNetUserClaims, AspNetRoleClaims, AspNetUserLogins, AspNetUserTokens

> **_Ch√∫ th√≠ch:_** _C√°c b·∫£ng Identity kh√°c ƒë∆∞·ª£c t·ª± ƒë·ªông t·∫°o b·ªüi EFCore, kh√¥ng c·∫ßn c·∫•u h√¨nh th√™m._

#### üõí Core eCommerce Tables

##### 5. Products

| Column Name           | Data Type        | Constraints                     | Description                   |
| --------------------- | ---------------- | ------------------------------- | ----------------------------- |
| Id                    | uniqueidentifier | PK                              | ƒê·ªãnh danh s·∫£n ph·∫©m            |
| Name                  | nvarchar(200)    | NOT NULL, INDEX                 | T√™n s·∫£n ph·∫©m                  |
| Description           | nvarchar(max)    |                                 | M√¥ t·∫£ s·∫£n ph·∫©m                |
| ShortDescription      | nvarchar(500)    |                                 | M√¥ t·∫£ ng·∫Øn                    |
| Price                 | decimal(18,2)    | NOT NULL                        | Gi√° g·ªëc                       |
| OldPrice              | decimal(18,2)    |                                 | Gi√° c≈© (khi gi·∫£m gi√°)         |
| SpecialPrice          | decimal(18,2)    |                                 | Gi√° ƒë·∫∑c bi·ªát                  |
| SpecialPriceStartDate | datetime2        |                                 | Ng√†y b·∫Øt ƒë·∫ßu gi√° ƒë·∫∑c bi·ªát     |
| SpecialPriceEndDate   | datetime2        |                                 | Ng√†y k·∫øt th√∫c gi√° ƒë·∫∑c bi·ªát    |
| Sku                   | nvarchar(100)    | INDEX, UNIQUE                   | Stock Keeping Unit            |
| Gtin                  | nvarchar(100)    | INDEX                           | Global Trade Item Number      |
| CategoryId            | uniqueidentifier | FK, INDEX                       | ID danh m·ª•c                   |
| BrandId               | uniqueidentifier | FK, INDEX                       | ID th∆∞∆°ng hi·ªáu                |
| IsActive              | bit              | NOT NULL, DEFAULT(1)            | Tr·∫°ng th√°i k√≠ch ho·∫°t          |
| IsFeatured            | bit              | NOT NULL, DEFAULT(0)            | S·∫£n ph·∫©m n·ªïi b·∫≠t              |
| IsDeleted             | bit              | NOT NULL, DEFAULT(0)            | Tr·∫°ng th√°i x√≥a m·ªÅm            |
| CreatedAt             | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Ng√†y t·∫°o                      |
| CreatedBy             | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi t·∫°o                     |
| ModifiedAt            | datetime2        |                                 | Ng√†y s·ª≠a ƒë·ªïi                  |
| ModifiedBy            | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi s·ª≠a ƒë·ªïi                 |
| DeletedAt             | datetime2        |                                 | Ng√†y x√≥a                      |
| DeletedBy             | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi x√≥a                     |
| StockQuantity         | int              | NOT NULL, DEFAULT(0)            | **(Moved to ProductVariant)** |
| Weight                | decimal(18,4)    |                                 | **(Moved to ProductVariant)** |
| Length                | decimal(18,4)    |                                 | **(Moved to ProductVariant)** |
| Width                 | decimal(18,4)    |                                 | **(Moved to ProductVariant)** |
| Height                | decimal(18,4)    |                                 | **(Moved to ProductVariant)** |

##### 6. ProductVariants (NEW/MODIFIED Table for Variants)

| Column Name      | Data Type        | Constraints                       | Description           |
| ---------------- | ---------------- | --------------------------------- | --------------------- |
| Id               | uniqueidentifier | PK                                | ƒê·ªãnh danh bi·∫øn th·ªÉ    |
| ProductId        | uniqueidentifier | FK (Products.Id), NOT NULL, INDEX | ID s·∫£n ph·∫©m cha       |
| Name             | nvarchar(200)    |                                   | T√™n bi·∫øn th·ªÉ (n·∫øu c√≥) |
| Sku              | nvarchar(100)    | INDEX, UNIQUE                     | SKU c·ªßa bi·∫øn th·ªÉ      |
| Price            | decimal(18,2)    | NOT NULL                          | Gi√° c·ªßa bi·∫øn th·ªÉ      |
| OldPrice         | decimal(18,2)    |                                   | Gi√° c≈© c·ªßa bi·∫øn th·ªÉ   |
| StockQuantity    | int              | NOT NULL, DEFAULT(0)              | S·ªë l∆∞·ª£ng t·ªìn kho      |
| ReservedQuantity | int              | NOT NULL, DEFAULT(0)              | S·ªë l∆∞·ª£ng ƒë·∫∑t tr∆∞·ªõc    |
| Weight           | decimal(18,4)    |                                   | Tr·ªçng l∆∞·ª£ng           |
| Length           | decimal(18,4)    |                                   | Chi·ªÅu d√†i             |
| Width            | decimal(18,4)    |                                   | Chi·ªÅu r·ªông            |
| Height           | decimal(18,4)    |                                   | Chi·ªÅu cao             |
| AttributesJSON   | nvarchar(max)    |                                   | Thu·ªôc t√≠nh (JSON)     |
| ImageUrl         | nvarchar(500)    |                                   | ·∫¢nh ƒë·∫°i di·ªán bi·∫øn th·ªÉ |
| IsActive         | bit              | NOT NULL, DEFAULT(1)              | Tr·∫°ng th√°i k√≠ch ho·∫°t  |
| CreatedAt        | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())   | Ng√†y t·∫°o              |
| CreatedBy        | nvarchar(450)    | FK (AspNetUsers.Id)               | Ng∆∞·ªùi t·∫°o             |
| ModifiedAt       | datetime2        |                                   | Ng√†y s·ª≠a ƒë·ªïi          |
| ModifiedBy       | nvarchar(450)    | FK (AspNetUsers.Id)               | Ng∆∞·ªùi s·ª≠a ƒë·ªïi         |

##### 7. ProductImages

| Column Name      | Data Type        | Constraints                       | Description                             |
| ---------------- | ---------------- | --------------------------------- | --------------------------------------- |
| Id               | uniqueidentifier | PK                                | ƒê·ªãnh danh ·∫£nh                           |
| ProductId        | uniqueidentifier | FK (Products.Id), NOT NULL, INDEX | ID s·∫£n ph·∫©m                             |
| ProductVariantId | uniqueidentifier | FK (ProductVariants.Id), INDEX    | ID bi·∫øn th·ªÉ (n·∫øu ·∫£nh ri√™ng cho variant) |
| ImageUrl         | nvarchar(500)    | NOT NULL                          | URL ·∫£nh                                 |
| AltText          | nvarchar(200)    |                                   | VƒÉn b·∫£n thay th·∫ø                        |
| DisplayOrder     | int              | NOT NULL, DEFAULT(0)              | Th·ª© t·ª± hi·ªÉn th·ªã                         |
| CreatedAt        | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())   | Ng√†y t·∫°o                                |
| CreatedBy        | nvarchar(450)    | FK (AspNetUsers.Id)               | Ng∆∞·ªùi t·∫°o                               |

##### 8. ProductAttributes (Consider using JSON in Product or Variant)

| Column Name    | Data Type        | Constraints                       | Description          |
| -------------- | ---------------- | --------------------------------- | -------------------- |
| Id             | uniqueidentifier | PK                                | ƒê·ªãnh danh thu·ªôc t√≠nh |
| ProductId      | uniqueidentifier | FK (Products.Id), NOT NULL, INDEX | ID s·∫£n ph·∫©m          |
| AttributeName  | nvarchar(100)    | NOT NULL                          | T√™n thu·ªôc t√≠nh       |
| AttributeValue | nvarchar(500)    | NOT NULL                          | Gi√° tr·ªã thu·ªôc t√≠nh   |
| DisplayOrder   | int              | NOT NULL, DEFAULT(0)              | Th·ª© t·ª± hi·ªÉn th·ªã      |
| CreatedAt      | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())   | Ng√†y t·∫°o             |
| CreatedBy      | nvarchar(450)    | FK (AspNetUsers.Id)               | Ng∆∞·ªùi t·∫°o            |

##### 9. Categories

| Column Name     | Data Type        | Constraints                     | Description          |
| --------------- | ---------------- | ------------------------------- | -------------------- |
| Id              | uniqueidentifier | PK                              | ƒê·ªãnh danh danh m·ª•c   |
| Name            | nvarchar(200)    | NOT NULL, INDEX                 | T√™n danh m·ª•c         |
| Description     | nvarchar(500)    |                                 | M√¥ t·∫£                |
| ParentId        | uniqueidentifier | FK (Categories.Id), INDEX       | ID danh m·ª•c cha      |
| DisplayOrder    | int              | NOT NULL, DEFAULT(0)            | Th·ª© t·ª± hi·ªÉn th·ªã      |
| IsActive        | bit              | NOT NULL, DEFAULT(1)            | Tr·∫°ng th√°i k√≠ch ho·∫°t |
| ImageUrl        | nvarchar(500)    |                                 | URL h√¨nh ·∫£nh         |
| Slug            | nvarchar(200)    | NOT NULL, INDEX, UNIQUE         | URL th√¢n thi·ªán       |
| MetaTitle       | nvarchar(200)    |                                 | Ti√™u ƒë·ªÅ SEO          |
| MetaKeywords    | nvarchar(500)    |                                 | T·ª´ kh√≥a SEO          |
| MetaDescription | nvarchar(500)    |                                 | M√¥ t·∫£ SEO            |
| IsDeleted       | bit              | NOT NULL, DEFAULT(0)            | Tr·∫°ng th√°i x√≥a m·ªÅm   |
| CreatedAt       | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Ng√†y t·∫°o             |
| CreatedBy       | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi t·∫°o            |
| ModifiedAt      | datetime2        |                                 | Ng√†y s·ª≠a ƒë·ªïi         |
| ModifiedBy      | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi s·ª≠a ƒë·ªïi        |
| DeletedAt       | datetime2        |                                 | Ng√†y x√≥a             |
| DeletedBy       | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi x√≥a            |

##### 10. Brands

| Column Name  | Data Type        | Constraints                     | Description           |
| ------------ | ---------------- | ------------------------------- | --------------------- |
| Id           | uniqueidentifier | PK                              | ƒê·ªãnh danh th∆∞∆°ng hi·ªáu |
| Name         | nvarchar(200)    | NOT NULL, INDEX                 | T√™n th∆∞∆°ng hi·ªáu       |
| Description  | nvarchar(500)    |                                 | M√¥ t·∫£                 |
| LogoUrl      | nvarchar(500)    |                                 | URL logo              |
| IsActive     | bit              | NOT NULL, DEFAULT(1)            | Tr·∫°ng th√°i k√≠ch ho·∫°t  |
| DisplayOrder | int              | NOT NULL, DEFAULT(0)            | Th·ª© t·ª± hi·ªÉn th·ªã       |
| Slug         | nvarchar(200)    | NOT NULL, INDEX, UNIQUE         | URL th√¢n thi·ªán        |
| IsDeleted    | bit              | NOT NULL, DEFAULT(0)            | Tr·∫°ng th√°i x√≥a m·ªÅm    |
| CreatedAt    | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Ng√†y t·∫°o              |
| CreatedBy    | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi t·∫°o             |
| ModifiedAt   | datetime2        |                                 | Ng√†y s·ª≠a ƒë·ªïi          |
| ModifiedBy   | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi s·ª≠a ƒë·ªïi         |
| DeletedAt    | datetime2        |                                 | Ng√†y x√≥a              |
| DeletedBy    | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi x√≥a             |

##### 11. Orders

| Column Name       | Data Type        | Constraints                            | Description            |
| ----------------- | ---------------- | -------------------------------------- | ---------------------- |
| Id                | uniqueidentifier | PK                                     | ƒê·ªãnh danh ƒë∆°n h√†ng     |
| OrderNumber       | nvarchar(50)     | NOT NULL, INDEX, UNIQUE                | S·ªë ƒë∆°n h√†ng            |
| CustomerId        | uniqueidentifier | FK (Customers.Id), NOT NULL, INDEX     | ID kh√°ch h√†ng          |
| OrderDate         | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())        | Ng√†y ƒë·∫∑t h√†ng          |
| OrderStatusId     | int              | FK (OrderStatuses.Id), NOT NULL, INDEX | Tr·∫°ng th√°i             |
| ShippingAddressId | uniqueidentifier | FK (Addresses.Id), NOT NULL            | ƒê·ªãa ch·ªâ giao h√†ng      |
| BillingAddressId  | uniqueidentifier | FK (Addresses.Id)                      | ƒê·ªãa ch·ªâ thanh to√°n     |
| PaymentMethodId   | int              | FK (PaymentMethods.Id)                 | Ph∆∞∆°ng th·ª©c thanh to√°n |
| ShippingMethodId  | int              | FK (ShippingMethods.Id)                | Ph∆∞∆°ng th·ª©c v·∫≠n chuy·ªÉn |
| SubTotal          | decimal(18,2)    | NOT NULL                               | T·ªïng ti·ªÅn h√†ng         |
| ShippingCost      | decimal(18,2)    | NOT NULL, DEFAULT(0)                   | Ph√≠ v·∫≠n chuy·ªÉn         |
| TaxAmount         | decimal(18,2)    | NOT NULL, DEFAULT(0)                   | Thu·∫ø                   |
| DiscountAmount    | decimal(18,2)    | NOT NULL, DEFAULT(0)                   | Gi·∫£m gi√°               |
| TotalAmount       | decimal(18,2)    | NOT NULL                               | T·ªïng c·ªông              |
| Notes             | nvarchar(max)    |                                        | Ghi ch√∫ c·ªßa KH         |
| AdminNotes        | nvarchar(max)    |                                        | Ghi ch√∫ c·ªßa Admin      |
| CouponCode        | nvarchar(50)     | INDEX                                  | M√£ gi·∫£m gi√° ƒë√£ d√πng    |
| IsDeleted         | bit              | NOT NULL, DEFAULT(0)                   | Tr·∫°ng th√°i x√≥a m·ªÅm     |
| CreatedAt         | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())        | Ng√†y t·∫°o               |
| CreatedBy         | nvarchar(450)    | FK (AspNetUsers.Id)                    | Ng∆∞·ªùi t·∫°o (N·∫øu KH t·∫°o) |
| ModifiedAt        | datetime2        |                                        | Ng√†y s·ª≠a ƒë·ªïi           |
| ModifiedBy        | nvarchar(450)    | FK (AspNetUsers.Id)                    | Ng∆∞·ªùi s·ª≠a ƒë·ªïi          |
| DeletedAt         | datetime2        |                                        | Ng√†y x√≥a               |
| DeletedBy         | nvarchar(450)    | FK (AspNetUsers.Id)                    | Ng∆∞·ªùi x√≥a              |

##### 12. OrderItems

| Column Name        | Data Type        | Constraints                              | Description               |
| ------------------ | ---------------- | ---------------------------------------- | ------------------------- |
| Id                 | uniqueidentifier | PK                                       | ƒê·ªãnh danh m·ª•c ƒë∆°n h√†ng    |
| OrderId            | uniqueidentifier | FK (Orders.Id), NOT NULL, INDEX          | ID ƒë∆°n h√†ng               |
| ProductVariantId   | uniqueidentifier | FK (ProductVariants.Id), NOT NULL, INDEX | ID bi·∫øn th·ªÉ s·∫£n ph·∫©m      |
| Quantity           | int              | NOT NULL                                 | S·ªë l∆∞·ª£ng                  |
| UnitPrice          | decimal(18,2)    | NOT NULL                                 | ƒê∆°n gi√° t·∫°i th·ªùi ƒëi·ªÉm mua |
| TotalPrice         | decimal(18,2)    | NOT NULL                                 | Th√†nh ti·ªÅn                |
| ProductName        | nvarchar(200)    | NOT NULL                                 | T√™n SP (snapshot)         |
| ProductVariantName | nvarchar(200)    |                                          | T√™n bi·∫øn th·ªÉ (snapshot)   |
| Sku                | nvarchar(100)    |                                          | M√£ SKU (snapshot)         |
| CreatedAt          | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())          | Ng√†y t·∫°o                  |

##### 13. OrderStatuses (Lookup Table)

| Column Name  | Data Type     | Constraints | Description          |
| ------------ | ------------- | ----------- | -------------------- |
| Id           | int           | PK          | ƒê·ªãnh danh tr·∫°ng th√°i |
| Name         | nvarchar(50)  | NOT NULL    | T√™n tr·∫°ng th√°i       |
| Description  | nvarchar(200) |             | M√¥ t·∫£                |
| DisplayOrder | int           | NOT NULL    | Th·ª© t·ª± hi·ªÉn th·ªã      |
| IsDefault    | bit           | DEFAULT(0)  | Tr·∫°ng th√°i m·∫∑c ƒë·ªãnh  |

##### 14. PaymentMethods (Lookup Table)

| Column Name        | Data Type     | Constraints          | Description             |
| ------------------ | ------------- | -------------------- | ----------------------- |
| Id                 | int           | PK                   | ƒê·ªãnh danh ph∆∞∆°ng th·ª©c   |
| Name               | nvarchar(100) | NOT NULL             | T√™n ph∆∞∆°ng th·ª©c         |
| Description        | nvarchar(500) |                      | M√¥ t·∫£                   |
| IsActive           | bit           | NOT NULL, DEFAULT(1) | Tr·∫°ng th√°i k√≠ch ho·∫°t    |
| DisplayOrder       | int           | NOT NULL             | Th·ª© t·ª± hi·ªÉn th·ªã         |
| AdditionalSettings | nvarchar(max) |                      | C·∫•u h√¨nh b·ªï sung (JSON) |

##### 15. ShippingMethods (Lookup Table)

| Column Name     | Data Type     | Constraints          | Description              |
| --------------- | ------------- | -------------------- | ------------------------ |
| Id              | int           | PK                   | ƒê·ªãnh danh ph∆∞∆°ng th·ª©c    |
| Name            | nvarchar(100) | NOT NULL             | T√™n ph∆∞∆°ng th·ª©c          |
| Description     | nvarchar(500) |                      | M√¥ t·∫£                    |
| Price           | decimal(18,2) | NOT NULL             | Gi√°                      |
| DeliveryTimeMin | int           |                      | Th·ªùi gian giao t·ªëi thi·ªÉu |
| DeliveryTimeMax | int           |                      | Th·ªùi gian giao t·ªëi ƒëa    |
| IsActive        | bit           | NOT NULL, DEFAULT(1) | Tr·∫°ng th√°i k√≠ch ho·∫°t     |
| DisplayOrder    | int           | NOT NULL             | Th·ª© t·ª± hi·ªÉn th·ªã          |

#### Customer Management Tables

##### 16. Customers

| Column Name              | Data Type        | Constraints                        | Description                    |
| ------------------------ | ---------------- | ---------------------------------- | ------------------------------ |
| Id                       | uniqueidentifier | PK                                 | ƒê·ªãnh danh kh√°ch h√†ng           |
| UserId                   | nvarchar(450)    | FK (AspNetUsers.Id), INDEX, UNIQUE | ID ng∆∞·ªùi d√πng li√™n k·∫øt         |
| FirstName                | nvarchar(100)    | NOT NULL                           | T√™n                            |
| LastName                 | nvarchar(100)    | NOT NULL                           | H·ªç                             |
| Email                    | nvarchar(256)    | NOT NULL, INDEX, UNIQUE            | Email (c√≥ th·ªÉ kh√°c AspNetUser) |
| PhoneNumber              | nvarchar(20)     | INDEX                              | S·ªë ƒëi·ªán tho·∫°i                  |
| DateOfBirth              | date             |                                    | Ng√†y sinh                      |
| Gender                   | nvarchar(10)     |                                    | Gi·ªõi t√≠nh                      |
| CustomerTypeId           | int              | FK (CustomerTypes.Id)              | Lo·∫°i kh√°ch h√†ng                |
| IsSubscribedToNewsletter | bit              | NOT NULL, DEFAULT(0)               | ƒêƒÉng k√Ω newsletter             |
| IsDeleted                | bit              | NOT NULL, DEFAULT(0)               | Tr·∫°ng th√°i x√≥a m·ªÅm             |
| CreatedAt                | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())    | Ng√†y t·∫°o                       |
| CreatedBy                | nvarchar(450)    | FK (AspNetUsers.Id)                | Ng∆∞·ªùi t·∫°o                      |
| ModifiedAt               | datetime2        |                                    | Ng√†y s·ª≠a ƒë·ªïi                   |
| ModifiedBy               | nvarchar(450)    | FK (AspNetUsers.Id)                | Ng∆∞·ªùi s·ª≠a ƒë·ªïi                  |
| DeletedAt                | datetime2        |                                    | Ng√†y x√≥a                       |
| DeletedBy                | nvarchar(450)    | FK (AspNetUsers.Id)                | Ng∆∞·ªùi x√≥a                      |

##### 17. Addresses

| Column Name       | Data Type        | Constraints                        | Description                 |
| ----------------- | ---------------- | ---------------------------------- | --------------------------- |
| Id                | uniqueidentifier | PK                                 | ƒê·ªãnh danh ƒë·ªãa ch·ªâ           |
| CustomerId        | uniqueidentifier | FK (Customers.Id), NOT NULL, INDEX | ID kh√°ch h√†ng               |
| FirstName         | nvarchar(100)    | NOT NULL                           | T√™n ng∆∞·ªùi nh·∫≠n              |
| LastName          | nvarchar(100)    | NOT NULL                           | H·ªç ng∆∞·ªùi nh·∫≠n               |
| AddressLine1      | nvarchar(200)    | NOT NULL                           | ƒê·ªãa ch·ªâ d√≤ng 1              |
| AddressLine2      | nvarchar(200)    |                                    | ƒê·ªãa ch·ªâ d√≤ng 2              |
| City              | nvarchar(100)    | NOT NULL                           | Th√†nh ph·ªë                   |
| State             | nvarchar(100)    |                                    | T·ªânh/Bang                   |
| PostalCode        | nvarchar(20)     |                                    | M√£ b∆∞u ƒëi·ªán                 |
| CountryId         | int              | FK (Countries.Id), NOT NULL        | ID qu·ªëc gia                 |
| PhoneNumber       | nvarchar(20)     |                                    | S·ªë ƒëi·ªán tho·∫°i ng∆∞·ªùi nh·∫≠n    |
| IsDefaultShipping | bit              | NOT NULL, DEFAULT(0)               | ƒê·ªãa ch·ªâ giao h√†ng m·∫∑c ƒë·ªãnh  |
| IsDefaultBilling  | bit              | NOT NULL, DEFAULT(0)               | ƒê·ªãa ch·ªâ thanh to√°n m·∫∑c ƒë·ªãnh |
| CreatedAt         | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())    | Ng√†y t·∫°o                    |
| CreatedBy         | nvarchar(450)    | FK (AspNetUsers.Id)                | Ng∆∞·ªùi t·∫°o                   |
| ModifiedAt        | datetime2        |                                    | Ng√†y s·ª≠a ƒë·ªïi                |
| ModifiedBy        | nvarchar(450)    | FK (AspNetUsers.Id)                | Ng∆∞·ªùi s·ª≠a ƒë·ªïi               |

##### 18. Countries (Lookup Table)

| Column Name  | Data Type     | Constraints          | Description          |
| ------------ | ------------- | -------------------- | -------------------- |
| Id           | int           | PK                   | ƒê·ªãnh danh qu·ªëc gia   |
| Name         | nvarchar(100) | NOT NULL             | T√™n qu·ªëc gia         |
| IsoCode      | nvarchar(2)   | NOT NULL, UNIQUE     | M√£ ISO2              |
| IsoCode3     | nvarchar(3)   | UNIQUE               | M√£ ISO3              |
| IsActive     | bit           | NOT NULL, DEFAULT(1) | Tr·∫°ng th√°i k√≠ch ho·∫°t |
| DisplayOrder | int           | NOT NULL             | Th·ª© t·ª± hi·ªÉn th·ªã      |

##### 19. CustomerTypes (Lookup Table)

| Column Name        | Data Type     | Constraints | Description               |
| ------------------ | ------------- | ----------- | ------------------------- |
| Id                 | int           | PK          | ƒê·ªãnh danh lo·∫°i kh√°ch h√†ng |
| Name               | nvarchar(100) | NOT NULL    | T√™n lo·∫°i                  |
| Description        | nvarchar(500) |             | M√¥ t·∫£                     |
| DiscountPercentage | decimal(5,2)  |             | % gi·∫£m gi√° m·∫∑c ƒë·ªãnh       |

#### Inventory & Stock Tables (ƒê∆°n gi·∫£n h√≥a - T·ªìn kho theo ProductVariant)

##### 20. InventoryHistory (Theo d√µi thay ƒë·ªïi t·ªìn kho)

| Column Name      | Data Type        | Constraints                              | Description                                  |
| ---------------- | ---------------- | ---------------------------------------- | -------------------------------------------- |
| Id               | uniqueidentifier | PK                                       | ƒê·ªãnh danh l·ªãch s·ª≠                            |
| ProductVariantId | uniqueidentifier | FK (ProductVariants.Id), NOT NULL, INDEX | ID bi·∫øn th·ªÉ                                  |
| WarehouseId      | uniqueidentifier | FK (Warehouses.Id), NOT NULL, INDEX      | ID kho h√†ng                                  |
| QuantityChange   | int              | NOT NULL                                 | Thay ƒë·ªïi s·ªë l∆∞·ª£ng (+/-)                      |
| QuantityBefore   | int              | NOT NULL                                 | S·ªë l∆∞·ª£ng tr∆∞·ªõc                               |
| QuantityAfter    | int              | NOT NULL                                 | S·ªë l∆∞·ª£ng sau                                 |
| Note             | nvarchar(500)    |                                          | Ghi ch√∫                                      |
| ReferenceType    | nvarchar(50)     | INDEX                                    | Lo·∫°i tham chi·∫øu (Order, Stock Adjustment...) |
| ReferenceId      | nvarchar(128)    | INDEX                                    | ID tham chi·∫øu                                |
| CreatedAt        | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())          | Ng√†y t·∫°o                                     |
| CreatedBy        | nvarchar(450)    | FK (AspNetUsers.Id), NOT NULL            | Ng∆∞·ªùi t·∫°o                                    |

##### 21. Warehouses

| Column Name  | Data Type        | Constraints                     | Description          |
| ------------ | ---------------- | ------------------------------- | -------------------- |
| Id           | uniqueidentifier | PK                              | ƒê·ªãnh danh kho h√†ng   |
| Name         | nvarchar(200)    | NOT NULL, INDEX                 | T√™n kho h√†ng         |
| AddressLine1 | nvarchar(200)    | NOT NULL                        | ƒê·ªãa ch·ªâ d√≤ng 1       |
| AddressLine2 | nvarchar(200)    |                                 | ƒê·ªãa ch·ªâ d√≤ng 2       |
| City         | nvarchar(100)    | NOT NULL                        | Th√†nh ph·ªë            |
| State        | nvarchar(100)    |                                 | T·ªânh/Bang            |
| PostalCode   | nvarchar(20)     |                                 | M√£ b∆∞u ƒëi·ªán          |
| CountryId    | int              | FK (Countries.Id), NOT NULL     | ID qu·ªëc gia          |
| PhoneNumber  | nvarchar(20)     |                                 | S·ªë ƒëi·ªán tho·∫°i        |
| Email        | nvarchar(256)    |                                 | Email                |
| IsActive     | bit              | NOT NULL, DEFAULT(1)            | Tr·∫°ng th√°i k√≠ch ho·∫°t |
| IsDeleted    | bit              | NOT NULL, DEFAULT(0)            | Tr·∫°ng th√°i x√≥a m·ªÅm   |
| CreatedAt    | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Ng√†y t·∫°o             |
| CreatedBy    | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi t·∫°o            |
| ModifiedAt   | datetime2        |                                 | Ng√†y s·ª≠a ƒë·ªïi         |
| ModifiedBy   | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi s·ª≠a ƒë·ªïi        |
| DeletedAt    | datetime2        |                                 | Ng√†y x√≥a             |
| DeletedBy    | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi x√≥a            |

#### Review & Rating Tables

##### 22. ProductReviews

| Column Name        | Data Type        | Constraints                             | Description          |
| ------------------ | ---------------- | --------------------------------------- | -------------------- |
| Id                 | uniqueidentifier | PK                                      | ƒê·ªãnh danh ƒë√°nh gi√°   |
| ProductId          | uniqueidentifier | FK (Products.Id), NOT NULL, INDEX       | ID s·∫£n ph·∫©m          |
| CustomerId         | uniqueidentifier | FK (Customers.Id), NOT NULL, INDEX      | ID kh√°ch h√†ng        |
| OrderItemId        | uniqueidentifier | FK (OrderItems.Id), INDEX               | ID m·ª•c ƒë∆°n h√†ng      |
| Rating             | int              | NOT NULL, CHECK(Rating BETWEEN 1 AND 5) | ƒêi·ªÉm (1-5)           |
| ReviewText         | nvarchar(max)    |                                         | N·ªôi dung ƒë√°nh gi√°    |
| Title              | nvarchar(200)    |                                         | Ti√™u ƒë·ªÅ ƒë√°nh gi√°     |
| IsApproved         | bit              | NOT NULL, DEFAULT(0)                    | ƒê√£ duy·ªát             |
| IsVerifiedPurchase | bit              | NOT NULL, DEFAULT(0)                    | ƒê√£ x√°c minh mua h√†ng |
| CreatedAt          | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())         | Ng√†y t·∫°o             |
| CreatedBy          | nvarchar(450)    | FK (AspNetUsers.Id)                     | Ng∆∞·ªùi t·∫°o (n·∫øu c√≥)   |
| ModifiedAt         | datetime2        |                                         | Ng√†y s·ª≠a ƒë·ªïi         |
| ModifiedBy         | nvarchar(450)    | FK (AspNetUsers.Id)                     | Ng∆∞·ªùi s·ª≠a ƒë·ªïi        |

##### 23. ReviewHelpfulness

| Column Name | Data Type        | Constraints                          | Description   |
| ----------- | ---------------- | ------------------------------------ | ------------- |
| ReviewId    | uniqueidentifier | PK, FK (ProductReviews.Id), NOT NULL | ID ƒë√°nh gi√°   |
| CustomerId  | uniqueidentifier | PK, FK (Customers.Id), NOT NULL      | ID kh√°ch h√†ng |
| IsHelpful   | bit              | NOT NULL                             | C√≥ h·ªØu √≠ch    |
| CreatedAt   | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())      | Ng√†y t·∫°o      |

#### Marketing Tables

##### 24. Discounts

| Column Name           | Data Type        | Constraints                     | Description                       |
| --------------------- | ---------------- | ------------------------------- | --------------------------------- |
| Id                    | uniqueidentifier | PK                              | ƒê·ªãnh danh gi·∫£m gi√°                |
| Name                  | nvarchar(200)    | NOT NULL                        | T√™n ch∆∞∆°ng tr√¨nh                  |
| Description           | nvarchar(500)    |                                 | M√¥ t·∫£                             |
| DiscountType          | int              | NOT NULL, INDEX                 | Lo·∫°i (Percentage, FixedAmount...) |
| DiscountValue         | decimal(18,2)    | NOT NULL                        | Gi√° tr·ªã gi·∫£m gi√° (% ho·∫∑c s·ªë ti·ªÅn) |
| MinimumOrderAmount    | decimal(18,2)    |                                 | Gi√° tr·ªã ƒë∆°n h√†ng t·ªëi thi·ªÉu        |
| MaximumDiscountAmount | decimal(18,2)    |                                 | Gi·∫£m gi√° t·ªëi ƒëa (cho lo·∫°i %)      |
| StartDate             | datetime2        | NOT NULL                        | Ng√†y b·∫Øt ƒë·∫ßu                      |
| EndDate               | datetime2        |                                 | Ng√†y k·∫øt th√∫c                     |
| CouponCode            | nvarchar(50)     | INDEX, UNIQUE                   | M√£ gi·∫£m gi√° (n·∫øu c√≥)              |
| UsesPerCustomer       | int              |                                 | S·ªë l·∫ßn s·ª≠ d·ª•ng/KH                 |
| UsesPerCoupon         | int              |                                 | T·ªïng s·ªë l·∫ßn s·ª≠ d·ª•ng               |
| IsActive              | bit              | NOT NULL, DEFAULT(1)            | Tr·∫°ng th√°i k√≠ch ho·∫°t              |
| CreatedAt             | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Ng√†y t·∫°o                          |
| CreatedBy             | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi t·∫°o                         |
| ModifiedAt            | datetime2        |                                 | Ng√†y s·ª≠a ƒë·ªïi                      |
| ModifiedBy            | nvarchar(450)    | FK (AspNetUsers.Id)             | Ng∆∞·ªùi s·ª≠a ƒë·ªïi                     |

##### 25. DiscountUsageHistory

| Column Name | Data Type        | Constraints                        | Description       |
| ----------- | ---------------- | ---------------------------------- | ----------------- |
| Id          | uniqueidentifier | PK                                 | ƒê·ªãnh danh s·ª≠ d·ª•ng |
| DiscountId  | uniqueidentifier | FK (Discounts.Id), NOT NULL, INDEX | ID gi·∫£m gi√°       |
| OrderId     | uniqueidentifier | FK (Orders.Id), NOT NULL, INDEX    | ID ƒë∆°n h√†ng       |
| CustomerId  | uniqueidentifier | FK (Customers.Id), NOT NULL, INDEX | ID kh√°ch h√†ng     |
| CreatedAt   | datetime2        | NOT NULL, DEFAULT(GETUTCDATE())    | Ng√†y s·ª≠ d·ª•ng      |

#### Logging & Audit Tables

##### 26. AuditLogs (Theo d√µi thay ƒë·ªïi d·ªØ li·ªáu)

| Column Name | Data Type        | Constraints                     | Description                        |
| ----------- | ---------------- | ------------------------------- | ---------------------------------- |
| Id          | uniqueidentifier | PK                              | ƒê·ªãnh danh log                      |
| UserId      | nvarchar(450)    | FK (AspNetUsers.Id), INDEX      | ID ng∆∞·ªùi d√πng th·ª±c hi·ªán            |
| EntityName  | nvarchar(100)    | NOT NULL, INDEX                 | T√™n entity                         |
| EntityId    | nvarchar(128)    | NOT NULL, INDEX                 | ID entity                          |
| Action      | nvarchar(50)     | NOT NULL, INDEX                 | H√†nh ƒë·ªông (Create, Update, Delete) |
| OldValues   | nvarchar(max)    |                                 | Gi√° tr·ªã c≈© (JSON)                  |
| NewValues   | nvarchar(max)    |                                 | Gi√° tr·ªã m·ªõi (JSON)                 |
| ClientIp    | nvarchar(50)     |                                 | ƒê·ªãa ch·ªâ IP client                  |
| CreatedAt   | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Th·ªùi gian                          |

##### 27. ActivityLogs (Theo d√µi ho·∫°t ƒë·ªông ng∆∞·ªùi d√πng/h·ªá th·ªëng)

| Column Name  | Data Type        | Constraints                     | Description                             |
| ------------ | ---------------- | ------------------------------- | --------------------------------------- |
| Id           | uniqueidentifier | PK                              | ƒê·ªãnh danh log                           |
| UserId       | nvarchar(450)    | FK (AspNetUsers.Id), INDEX      | ID ng∆∞·ªùi d√πng                           |
| ActivityType | nvarchar(100)    | NOT NULL, INDEX                 | Lo·∫°i ho·∫°t ƒë·ªông (Login, View Product...) |
| Description  | nvarchar(500)    |                                 | M√¥ t·∫£ chi ti·∫øt                          |
| EntityName   | nvarchar(100)    | INDEX                           | T√™n entity li√™n quan                    |
| EntityId     | nvarchar(128)    | INDEX                           | ID entity li√™n quan                     |
| IpAddress    | nvarchar(50)     |                                 | ƒê·ªãa ch·ªâ IP                              |
| UserAgent    | nvarchar(500)    |                                 | Tr√¨nh duy·ªát/thi·∫øt b·ªã                    |
| CreatedAt    | datetime2        | NOT NULL, DEFAULT(GETUTCDATE()) | Th·ªùi gian                               |

---

## 9. PH√ä DUY·ªÜT

| Vai tr√≤       | T√™n            | Ch·ªØ k√Ω | Ng√†y       |
| ------------- | -------------- | ------ | ---------- |
| Ng∆∞·ªùi y√™u c·∫ßu | phamtiendungcw | ‚úì      | 2023-02-10 |
| Qu·∫£n l√Ω d·ª± √°n | phamtiendungcw | ‚úì      | 2023-02-10 |
| Developer     | phamtiendungcw | ‚úì      | 2023-02-10 |
